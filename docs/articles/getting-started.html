<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with geosam • geosam</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="getting-started_files/libs/quarto-html/popper.min.js"></script><script src="getting-started_files/libs/quarto-html/tippy.umd.min.js"></script><link href="getting-started_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="getting-started_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with geosam">
<meta property="og:image" content="https://walker-data.com/geosam/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">geosam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/satellite-detection.html">Satellite Imagery Detection</a></li>
    <li><a class="dropdown-item" href="../articles/image-detection.html">Regular Image Detection</a></li>
    <li><a class="dropdown-item" href="../articles/interactive.html">Interactive Workflows</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/walkerke/geosam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started with geosam</h1>




      <small class="dont-index">Source: <a href="https://github.com/walkerke/geosam/blob/HEAD/vignettes/getting-started.qmd" class="external-link"><code>vignettes/getting-started.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>geosam provides an R interface to Meta’s Segment Anything Model 3 (SAM3) for detecting objects in satellite imagery and photos. Unlike traditional computer vision approaches, SAM3 lets you describe what you’re looking for in plain text—no training data or model fine-tuning required.</p>
<p>The package is inspired by the Python package <a href="https://samgeo.gishub.org/" class="external-link">segment-geospatial</a> by Qiusheng Wu, and aims to bring similar functionality to R users. geosam offers an R-native API, linking to packages such as terra for spatial workflows and magick for image manipulation. It also includes tools for interactive viewing and extraction with the mapgl R package.</p>
<section class="level3"><h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Getting set up with geosam takes a few steps. First, install the package from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"walkerke/geosam"</span><span class="op">)</span></span></code></pre></div>
<p>Or:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"walkerke/geosam"</span><span class="op">)</span></span></code></pre></div>
<p>Once installed, load the package then set up a SAM3 Python environment with <code><a href="../reference/geosam_install.html">geosam_install()</a></code>. By default, if run with no arguments, <code><a href="../reference/geosam_install.html">geosam_install()</a></code> will use <strong>uv</strong> for the Python environment.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/geosam" class="external-link">geosam</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/geosam_install.html">geosam_install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This creates a dedicated uv environment with PyTorch and HuggingFace transformers.</p>
<p>If you prefer to use <strong>venv</strong> or <strong>conda</strong> for Python environment management, you can supply the appropriate argument to <code><a href="../reference/geosam_install.html">geosam_install()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geosam_install.html">geosam_install</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"conda"</span><span class="op">)</span> <span class="co"># or method = "virtualenv"</span></span></code></pre></div>
<p>This will set up a Python environment named <code>geosam</code> unless you supply an alternative name to <code>envname</code>.</p>
<section class="level4"><h4 id="windows-prerequisites">Windows prerequisites<a class="anchor" aria-label="anchor" href="#windows-prerequisites"></a>
</h4>
<p>On Windows, you’ll need a couple of additional tools:</p>
<ul>
<li>
<strong>Git</strong>: Required to install SAM3 from GitHub. Download from <a href="https://git-scm.com/download/win" class="external-link">git-scm.com</a> and install with default settings.</li>
<li>
<strong>Rtools</strong>: Required to compile some R package dependencies. Download from <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">CRAN</a>.</li>
</ul>
<p>After installing these, restart your R session before running <code><a href="../reference/geosam_install.html">geosam_install()</a></code>.</p>
</section></section><section class="level3"><h3 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h3>
<p>geosam uses Meta’s SAM3 model hosted on HuggingFace, which requires authentication. You’ll need to complete two steps: request access to the model, and set up your access token.</p>
<section class="level4"><h4 id="requesting-sam3-access">Requesting SAM3 access<a class="anchor" aria-label="anchor" href="#requesting-sam3-access"></a>
</h4>
<p>First, visit the <a href="https://huggingface.co/facebook/sam3" class="external-link">SAM3 model page on HuggingFace</a> and click “Request access.” You’ll need a free HuggingFace account. Access is typically granted quickly, but may take a few hours.</p>
</section><section class="level4"><h4 id="setting-up-your-access-token">Setting up your access token<a class="anchor" aria-label="anchor" href="#setting-up-your-access-token"></a>
</h4>
<p>Once you have access, you’ll need a User Access Token. From your HuggingFace account, go to <strong>Settings &gt; Access Tokens</strong> and create a new token. A “read” token is sufficient for geosam since we’re only downloading model weights—and read tokens are safer in case your token is accidentally exposed.</p>
<p>The easiest way to authenticate is to save the token on your machine using the HuggingFace CLI. From your terminal:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">huggingface-cli</span> login</span></code></pre></div>
<p>This saves your token to <code>~/.cache/huggingface/token</code>, where geosam will find it automatically.</p>
<p>Alternatively, you can set the token as an environment variable in R. For persistent use across sessions, add it to your <code>.Renviron</code> file:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open your .Renviron file</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add this line:</span></span>
<span><span class="co"># HF_TOKEN=hf_xxxxx</span></span></code></pre></div>
<p>Or set it for a single session:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>HF_TOKEN <span class="op">=</span> <span class="st">"hf_xxxxx"</span><span class="op">)</span></span></code></pre></div>
</section><section class="level4"><h4 id="imagery-api-keys">Imagery API keys<a class="anchor" aria-label="anchor" href="#imagery-api-keys"></a>
</h4>
<p>For satellite imagery, geosam supports three providers. Mapbox offers high-quality imagery but requires an API key:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>MAPBOX_PUBLIC_TOKEN <span class="op">=</span> <span class="st">"pk.xxxxx"</span><span class="op">)</span></span></code></pre></div>
<p>Esri World Imagery works without any API key, making it a good option for getting started. MapTiler is also supported with the <code>MAPTILER_API_KEY</code> environment variable.</p>
</section></section><section class="level3"><h3 id="check-your-setup">Check your setup<a class="anchor" aria-label="anchor" href="#check-your-setup"></a>
</h3>
<p>Before running your first detection, verify that everything is configured correctly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geosam_status.html">geosam_status</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── geosam Status ───────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Environment: uv at /Users/kylewalker/.geosam/venvs/geosam</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Python: 3.12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Path: /Users/kylewalker/.geosam/venvs/geosam/bin/python</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ PyTorch 2.9.1: MPS (Apple Silicon)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ transformers: available (SAM3 via HuggingFace)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ HuggingFace token: configured</code></pre>
</div>
</div>
<p>This will show you the status of your Python environment, whether GPU acceleration is available (MPS on Apple Silicon, CUDA on NVIDIA), and whether your HuggingFace token is configured. If everything shows green checkmarks, you’re ready to go.</p>
</section><section class="level3"><h3 id="your-first-detection">Your first detection<a class="anchor" aria-label="anchor" href="#your-first-detection"></a>
</h3>
<p>Let’s detect football fields on the TCU campus in Fort Worth. The <code><a href="../reference/sam_detect.html">sam_detect()</a></code> function is the main workhorse for satellite imagery detection. You provide a bounding box, describe what you’re looking for with a text prompt, and geosam handles the rest—downloading imagery, running SAM3 inference, and returning georeferenced results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">field</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sam_detect.html">sam_detect</a></span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">97.372</span>, <span class="fl">32.707</span>, <span class="op">-</span><span class="fl">97.366</span>, <span class="fl">32.712</span><span class="op">)</span>,</span>
<span>  text <span class="op">=</span> <span class="st">"football field"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"mapbox"</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">17</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Mapbox imagery is governed by the Mapbox Terms of Service.
  See: &lt;https://www.mapbox.com/legal/tos/&gt;
ℹ Downloading Mapbox imagery at zoom 17...

ℹ Fetching 12 tiles (4x3)...

✔ Saved imagery to: /var/folders/qm/xbtsglmj2ss91z9fzpz8k6q8ylngb5/T//Rtmphmxw9e/file7c02307be280.tif

ℹ Reading image...

ℹ Running SAM3 detection...

✔ Detected 2 objects.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">field</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting-started_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>bbox</code> argument takes coordinates in WGS84 (longitude/latitude) as <code>c(xmin, ymin, xmax, ymax)</code>. You can also pass an sf object and geosam will extract its bounding box automatically.</p>
<p>The first time you run a detection, SAM3 will download model weights from HuggingFace (about 2.5 GB). This only happens once as subsequent runs use the cached model.</p>
</section><section class="level3"><h3 id="viewing-results">Viewing results<a class="anchor" aria-label="anchor" href="#viewing-results"></a>
</h3>
<p>Use <code><a href="../reference/sam_view.html">sam_view()</a></code> to explore your detections interactively:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sam_view.html">sam_view</a></span><span class="op">(</span><span class="va">field</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/paste-8.png"></p>
<p>This opens a Shiny application with the satellite imagery as a basemap and your detections overlaid as polygons. You can adjust the confidence threshold with a slider to filter out lower-quality detections, and click on individual polygons to see their confidence scores. Here, we’ve picked up the field inside the football stadium as well as the nearby practice field.</p>
<p>Zoom out a bit for this view - you’ll see a white box representing the extraction area. This is the area that we searched for features matching the text prompt.</p>
</section><section class="level3"><h3 id="extracting-polygons">Extracting polygons<a class="anchor" aria-label="anchor" href="#extracting-polygons"></a>
</h3>
<p>When you’re ready to work with the results in R, extract them as an sf object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">field_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sam_as_sf.html">sam_as_sf</a></span><span class="op">(</span><span class="va">field</span><span class="op">)</span></span>
<span></span>
<span><span class="va">field_sf</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 3 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -97.3687 ymin: 32.70723 xmax: -97.36656 ymax: 32.7102
Geodetic CRS:  WGS 84
      score mask_id                       geometry  area_m2
1 0.8473608       1 POLYGON ((-97.36773 32.7083... 17715.08
2 0.8100375       2 POLYGON ((-97.36834 32.7102... 11380.70</code></pre>
</div>
</div>
<p>The resulting sf object includes a <code>score</code> column with confidence values (0–1) and an <code>area_m2</code> column with the area of each detection in square meters. From here, you can filter, analyze, or export your detections using standard sf workflows.</p>
</section><section class="level3"><h3 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<ul>
<li>
<a href="satellite-detection.html">Satellite Imagery Detection</a> - Full guide to geospatial workflows</li>
<li>
<a href="image-detection.html">Regular Image Detection</a> - Working with photos and screenshots</li>
<li>
<a href="interactive.html">Interactive Workflows</a> - Using the explore and view interfaces</li>
</ul></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
