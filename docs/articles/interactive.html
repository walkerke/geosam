<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Interactive workflows • geosam</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="interactive_files/libs/quarto-html/popper.min.js"></script><script src="interactive_files/libs/quarto-html/tippy.umd.min.js"></script><link href="interactive_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="interactive_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interactive workflows">
<meta property="og:image" content="https://walker-data.com/geosam/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">geosam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/satellite-detection.html">Satellite Imagery Detection</a></li>
    <li><a class="dropdown-item" href="../articles/image-detection.html">Regular Image Detection</a></li>
    <li><a class="dropdown-item" href="../articles/interactive.html">Interactive Workflows</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/walkerke/geosam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interactive workflows</h1>




      <small class="dont-index">Source: <a href="https://github.com/walkerke/geosam/blob/HEAD/vignettes/interactive.qmd" class="external-link"><code>vignettes/interactive.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>geosam includes interactive Shiny tools for exploring imagery and running detections. This vignette covers <code><a href="../reference/sam_explore.html">sam_explore()</a></code>, the main interactive interface for satellite imagery.</p>
<section class="level2"><h2 id="exploring-satellite-imagery">Exploring satellite imagery<a class="anchor" aria-label="anchor" href="#exploring-satellite-imagery"></a>
</h2>
<p><code><a href="../reference/sam_explore.html">sam_explore()</a></code> opens an interactive map where you can navigate, detect objects, and export results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/geosam" class="external-link">geosam</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sam_explore.html">sam_explore</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"mapbox"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The interface lets you:</p>
<ul>
<li>
<strong>Navigate</strong> to any location using the map or search</li>
<li>
<strong>Text prompts</strong>: Type a description to detect objects (e.g., “swimming pool”)</li>
<li>
<strong>Exemplar prompts</strong>: Draw a shape around an example object to find similar ones</li>
<li>
<strong>Point prompts</strong>: Click on the map to indicate object locations</li>
<li>
<strong>Adjust threshold</strong>: Use the slider to filter by confidence</li>
<li>
<strong>Export</strong>: Return extracted results to your R session</li>
</ul>
<p>Let’s try this out. We’ll focus on the golf course at Colonial Country Club in Fort Worth. To initialize the map view at a specific location with <code><a href="../reference/sam_explore.html">sam_explore()</a></code>, specify a <code>center</code> and <code>zoom</code>. You can also supply a bounding box or sf object to <code>bbox</code> to initialize the view there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sam_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sam_explore.html">sam_explore</a></span><span class="op">(</span></span>
<span>  center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">97.373</span>, <span class="fl">32.719</span><span class="op">)</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">16</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p><img src="images/paste-4.png"></p>
<p>The explorer defaults to <code>source = "mapbox"</code>; use <code>"esri"</code> or <code>"maptiler"</code> for Esri World Imagery and MapTiler Satellite, respectively.</p>
<p>Let’s try a first detection with a text prompt. The explorer will search the visible area in the viewport. Set the confidence threshold to govern what you return, and the extraction zoom (16 through 18) to specify the level of detail for the underlying imagery. Choosing 16 will make the process run faster, and choosing 18 will give you the most accuracy.</p>
<p><img src="images/paste-5.png"></p>
<p>Our search for “sand traps” did a pretty good job! However, we do note some false positives, such as a sand trap found across the Trinity River that we know is incorrect. Given that we extracted over a large area with a high zoom (18), we also notice a few artifacts of the tiling process geosam uses internally (which can be cleaned up with <code><a href="../reference/sam_merge_edges.html">sam_merge_edges()</a></code>). In turn, it may make more sense to refine our search.</p>
<p>The “Example” mode allows us to use exemplar-based detection where we draw a shape around the object type we want, and tell SAM3 to extract everything in the image that looks like that shape. Vertex-based polygon drawing and rectangles are supported using mapgl’s draw control.</p>
<p><img src="images/paste-6.png"></p>
<p>In this example, we zoomed into a section of the golf course and drew a shape around a sand trap. We did a good job overall! there is one sand trap in the view that we missed - which as we can see is partially obscured by trees in the lower part of the view.</p>
<p>If you want to capture specific objects from the view, try the “Points” example. This will allow you to interactively click on locations on your map to tell SAM3 to extract objects at those locations. Let’s give this a try.</p>
<p><img src="images/paste-7.png"></p>
<p>In this example, I was able to manually locate sand traps, including the trap obscured by the tree; this helped SAM3 find it.</p>
<p>When you are finished with your interactive session, click the Done button. This will return your extraction result back to your R session, named as the object you assigned the <code><a href="../reference/sam_explore.html">sam_explore()</a></code> result to.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sam_result</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sam_as_sf.html">sam_as_sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Simple feature collection with 13 features and 3 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -97.37039 ymin: 32.72013 xmax: -97.36845 ymax: 32.72234
Geodetic CRS:  WGS 84
First 10 features:
       score mask_id                       geometry  area_m2
1  0.7930747       1 POLYGON ((-97.36881 32.7206... 139.7892
2  0.9364986       2 POLYGON ((-97.36856 32.7209... 231.4368
3  0.9188104       3 POLYGON ((-97.36898 32.7214... 172.9535
4  0.9192324       4 POLYGON ((-97.36919 32.7213... 166.5346
5  0.9121889       5 POLYGON ((-97.36904 32.7215... 107.6948
6  0.9012610       6 POLYGON ((-97.37033 32.7210... 277.7954
7  0.9021404       7 POLYGON ((-97.37017 32.7202... 235.3594
8  0.9207366       8 POLYGON ((-97.36995 32.7219... 202.5517
9  0.8797024       9 POLYGON ((-97.3702 32.72202... 109.8344
10 0.9075627      10 POLYGON ((-97.37001 32.7222... 154.4100</code></pre>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
