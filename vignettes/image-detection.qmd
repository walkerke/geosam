---
title: "Regular image detection"
format: html
editor: visual
eval: false
---

While geosam is built to work with geographic data, the package also honors SAM's core functionality: extracting from photos, screenshots, or any image file.

## Basic workflow

To work with non-georeferenced images, use `sam_image()`. We'll work with this sample photo for testing which is bundled in the package.

![](images/fruit_plate.jpg)

To extract objects from an image, we pass the image path to `sam_image()`:

```{r}
library(geosam)

# Path to bundled sample image
fruit <- system.file("extdata", "fruit_plate.jpg", package = "geosam")

# Detect strawberries
berries <- sam_image(fruit, text = "strawberry")

berries
```

We get a `geosam_image` object back. This object can be plotted with `plot()`:

```{r}
plot(berries)
```

SAM3 has found the strawberries. We can also try different prompts on the same image, then combine the plots with `add = TRUE`, much as we would in typical base R plotting.

Try different prompts on the same image:

```{r}
cherries <- sam_image(fruit, text = "cherry")
p <- plot(cherries)

chocolate <- sam_image(fruit, text = "chocolate")
plot(chocolate, add = TRUE, base_img = p, fill = "purple")
```

## Extracting results

Convert to an sf object (coordinates are in pixels):

```{r}
berries_sf <- sam_as_sf(berries)
berries_sf
```

The result includes `area_px` (area in square pixels) instead of `area_m2`.

## Interactive exploration

For hands-on detection with clicking and drawing, use `sam_explore_image()`:

```{r}
result <- sam_explore_image(fruit)
```

This opens a Shiny app where you can:

-   Enter text prompts
-   Click to place point prompts
-   Draw boxes around example objects
-   Adjust confidence threshold
-   Export results

The app is built on top of MapLibre, so you get the same interactive experience as you would with a satellite map!

When you click "Done", results are returned as a geosam_image object.